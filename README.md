üì± Speed Detector (C++ ‚Üí WebAssembly)

A high-precision, browser-based speed detection tool powered by C++, compiled to WebAssembly (WASM), and designed to run on iPhone and Mac.
The application uses the device‚Äôs GPS to calculate real-time speed, applying noise filtering to significantly reduce jitter when the device is stationary.

This project demonstrates:
	‚Ä¢	Cross-platform speed detection (iPhone via browser, Mac via localhost)
	‚Ä¢	C++ algorithms compiled to WebAssembly using Emscripten
	‚Ä¢	Real-time GPS consumption using the browser‚Äôs Geolocation API
	‚Ä¢	Runtime communication between JavaScript and WebAssembly
	‚Ä¢	Noise-filtered movement detection suitable for walking, cycling, and vehicle speed

‚∏ª

üöÄ Features

‚úîÔ∏è Pure C++ speed calculation
‚úîÔ∏è Compiled to WebAssembly (WASM)
‚úîÔ∏è Mobile-friendly HTML/JS interface
‚úîÔ∏è Works on iPhone Safari
‚úîÔ∏è Calculates speed from GPS using the Haversine formula
‚úîÔ∏è Filtering to prevent false movement (GPS jitter)
‚úîÔ∏è Works offline (except first load)
‚úîÔ∏è Can be served locally (Python server) or remotely (GitHub Pages / HTTPS)

‚∏ª

üß© Technology Stack
	‚Ä¢	C++17
	‚Ä¢	Emscripten (compiles C++ ‚Üí WebAssembly)
	‚Ä¢	HTML5 / JavaScript
	‚Ä¢	Geolocation API
	‚Ä¢	GitHub Pages or Localhost

‚∏ª

üóÇ Project Structure

speed-detector/
‚îú‚îÄ‚îÄ index.html          # Main UI + JS integration
‚îú‚îÄ‚îÄ speed.cpp           # Core C++ speed calculation
‚îú‚îÄ‚îÄ speed.js            # Generated by emcc (WebAssembly JS glue)
‚îú‚îÄ‚îÄ speed.wasm          # Generated WebAssembly binary
‚îî‚îÄ‚îÄ README.md           # Project documentation

You should not edit speed.js or speed.wasm; these are generated automatically.

‚∏ª

üõ†Ô∏è Build Instructions

1. Install Emscripten

git clone https://github.com/emscripten-core/emsdk.git ~/emsdk
cd ~/emsdk
./emsdk install latest
./emsdk activate latest
source ./emsdk_env.sh

To make emcc always available:

echo 'source ~/emsdk/emsdk_env.sh' >> ~/.zshrc
source ~/.zshrc


‚∏ª

2. Compile C++ to WebAssembly

Run this inside the project folder:

emcc speed.cpp \
  -O3 \
  -s EXPORTED_FUNCTIONS='["_add_sample","_ms_to_kmh","_reset"]' \
  -s EXPORTED_RUNTIME_METHODS='["cwrap"]' \
  -o speed.js

This creates:
	‚Ä¢	speed.js
	‚Ä¢	speed.wasm

‚∏ª

‚ñ∂Ô∏è Running Locally

1. Start a local server on your Mac:

python3 -m http.server 8000

2. Open in browser:

http://localhost:8000

3. To view on your iPhone:

Find your Mac‚Äôs IP address (e.g., 192.168.1.10), then open:

http://YOUR-MAC-IP:8000


‚∏ª

üîê Using on iPhone (HTTPS Requirement)

iOS often blocks GPS on non-HTTPS connections unless using localhost.

If GPS permission does not appear, use ngrok:

brew install ngrok
python3 -m http.server 8000
ngrok http 8000

Open the https://xxxx.ngrok-free.app URL on your iPhone.

‚∏ª

üéØ How It Works

1.GPS Position Input

The browser provides latitude, longitude, and timestamps via:

navigator.geolocation.watchPosition(...)

2. C++ Speed Calculation

The C++ module:
	‚Ä¢	Computes distance via the Haversine formula
	‚Ä¢	Calculates instantaneous speed
	‚Ä¢	Applies noise reduction:
	‚Ä¢	Distance threshold
	‚Ä¢	Time threshold
	‚Ä¢	Dead-zone speed clamp
	‚Ä¢	Exponential smoothing (EMA)

3. WebAssembly Execution

JavaScript calls into WASM functions:

addSample(lat, lon, timestamp);
msToKmh(speedMs);

4. UI Display

The result is shown in km/h and m/s with automatic clamping of tiny speeds to zero.

‚∏ª

üì¶ Deployment (GitHub Pages)

You can host this project online using GitHub Pages.

Steps:
	1.	Go to Repository ‚Üí Settings ‚Üí Pages
	2.	Select:
	‚Ä¢	Branch: main
	‚Ä¢	Folder: /root
	3.	Save

Your app will be live at:

https://your-username.github.io/speed-detector/

‚úîÔ∏è HTTPS
‚úîÔ∏è Works on iPhone
‚úîÔ∏è GPS permission allowed

‚∏ª