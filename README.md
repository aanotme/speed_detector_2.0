# ğŸ“± Speed Detector (C++ â†’ WebAssembly)

A high-precision, browser-based speed detection tool powered by **C++**, compiled to **WebAssembly (WASM)**, and designed to run on **iPhone** and **Mac**. The application uses the deviceâ€™s GPS to calculate real-time speed, applying noise filtering to significantly reduce jitter when the device is stationary.

---

## ğŸš€ Features

- Real-time GPS-based speed detection
- Noise-filtered movement tracking
- C++ core compiled to WebAssembly
- Mobile-friendly HTML/JS interface
- Works on iPhone via Safari
- Simple local development using Python HTTP server
- HTTPS-compatible for mobile usage (via GitHub Pages or ngrok)

---

## ğŸ§© Technology Stack

- **C++17**
- **Emscripten** (C++ â†’ WebAssembly)
- **HTML5 / JavaScript**
- **Geolocation API**
- **GitHub Pages / Localhost**

---

## ğŸ—‚ Project Structure

```
speed-detector/
â”œâ”€â”€ index.html          # Main UI + JS integration
â”œâ”€â”€ speed.cpp           # Core C++ speed calculation
â”œâ”€â”€ speed.js            # Generated by emcc (WebAssembly JS glue)
â”œâ”€â”€ speed.wasm          # Generated WebAssembly binary
â””â”€â”€ README.md           # Project documentation
```

> Do **not** manually edit `speed.js` or `speed.wasm`. They are generated automatically.

---

## ğŸ› ï¸ Build Instructions

### 1. Install Emscripten

```bash
git clone https://github.com/emscripten-core/emsdk.git ~/emsdk
cd ~/emsdk
./emsdk install latest
./emsdk activate latest
source ./emsdk_env.sh
```

To enable `emcc` permanently:

```bash
echo 'source ~/emsdk/emsdk_env.sh' >> ~/.zshrc
source ~/.zshrc
```

---

### 2. Compile C++ to WebAssembly

```bash
emcc speed.cpp \
  -O3 \
  -s EXPORTED_FUNCTIONS='["_add_sample","_ms_to_kmh","_reset"]' \
  -s EXPORTED_RUNTIME_METHODS='["cwrap"]' \
  -o speed.js
```

This will produce:

- `speed.js`
- `speed.wasm`

---

## â–¶ï¸ Running Locally

### 1. Start a local server:

```bash
python3 -m http.server 8000
```

### 2. Open locally:

```
http://localhost:8000
```

### 3. Open on your iPhone:

Find your Mac IP, e.g.: `192.168.1.10`

Then open:

```
http://192.168.1.10:8000
```

---

## ğŸ” iPhone GPS (HTTPS Requirement)

iOS may block GPS requests unless the page is served over **HTTPS**.

Use **ngrok** to create an HTTPS tunnel:

```bash
brew install ngrok
python3 -m http.server 8000
ngrok http 8000
```

Then open the **HTTPS link** that ngrok provides.

---

## ğŸ¯ How It Works

### 1. JavaScript reads GPS:

```js
navigator.geolocation.watchPosition(...)
```

### 2. Values are passed to WebAssembly:

```js
addSample(lat, lon, timestamp);
```

### 3. C++ computes speed using:

- Haversine distance
- Time delta
- Noise filtering (jitter threshold, dead-zone)
- Optional exponential smoothing

### 4. JS displays filtered values in km/h and m/s.

---

## ğŸ“¦ Deployment (GitHub Pages)

1. On GitHub: **Settings â†’ Pages**
2. Source: `main` branch
3. Folder: `/`

Your live link will look like:

```
https://your-username.github.io/speed-detector/
```

---

## ğŸ§ª Accuracy & Calibration

| Mode        | Jitter (m) | Deadzone (m/s) | EMA Î± |
|-------------|------------|----------------|-------|
| Walking     | 2â€“3        | 0.3â€“0.5        | 0.3   |
| Cycling     | 3â€“5        | 0.5â€“1.0        | 0.25  |
| Vehicle     | 5â€“8        | 1.0            | 0.2   |

---

## ğŸ—’ License

MIT License

---

## ğŸ¤ Contributing

Pull requests, bug reports, and feature suggestions are welcome!

